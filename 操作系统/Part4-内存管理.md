### 4-1. 内存管理概述
---
#### 1. 用户程序处理过程及地址空间概念和内存管理模式
1. 存储器层次结构
    - CPU -> CACHE -> 主存储器(内存、主村、磁盘缓冲) -> 辅助存储器(固定磁盘)
2. 用户程序处理过程
    - 符号名空间 -> 目标地址空间 -> 统一的目标地址空间 -> 物理地址空间
3. 实例
     <center><img src="/操作系统/All_pic/Screenshot 2024-10-09 at 20.43.04.png" width=50%></img></center>
#### 2. 程序的链接
1. 链接过程
    - 根据外部访问符号名表, 将经过编译的一组模块以及所需库函数, 装配成完整的模块
2. 链接方式
    - 静态链接方式、装入/运行时动态链接方式
3. 链接方式比较
    - 静态: 可执行文件, 难以实现内存模块共享
    - 装入时动态: 便于软件版本的修改、更新, 便于目标模块为多个应用程序共享
    - 运行时动态: 将某些链接推迟到执行时根据是否需要再完成, 有利于内存的利用
#### 3. 程序的装入与重定位
1. 程序的装入
    - 基本目标及相关问题
        1. 由装入程序将装入模块载入到内存
        2. 装入位置、地址变换及时机
    - 关键概念
        1. 相对、绝对地址、重定位及其寄存器
    - 装入方式
        1. 绝对装入(单道程序环境)
        2. 静态可重定位(多道程序)
        3. 动态运行时装入(运行中移动位置)
2. 绝对装入和可重定位装入模块实例
     <center><img src="/操作系统/All_pic/Screenshot 2024-10-09 at 20.53.06.png" width=50%></img></center>
3. (静态/动态)可重定位
    - 重定位
        1. 指令及数据地址的修改过程
    - 静态重定位
        1. 装入内存时一次性完成重定位
        2. 地址不再改变, 程序不能移动
    - 动态重定位
        1. 需要特殊硬件支持, 来保持地址转换不影响指令执行速度
        2. 便于动态链接和代码共享
4. 动态重定位示意图
     <center><img src="/操作系统/All_pic/Screenshot 2024-10-09 at 20.55.56.png" width=50%></img></center>
#### 4. OS内存管理功能目标及内存分配方式分类
1. 内存管理功能目标
    - 内存分配
    - 地址映射
    - 内存保护
    - 内存扩充
2. 连续/离散分配内存管理
    - 连续分配
        1. 单一连续分配
        2. 固定/动态(可重定位)分区分配
    - 连续存储管理弊端
        1. 碎片问题
        2. 对换、覆盖、伙伴技术
    - 离散分配及虚拟现实存储技术
        1. 分页
        2. 分段
        3. 段页式
---
### 4-2. 连续分配内存管理
#### 1. 单一连续分配内存管理
1. 单一连续分配方式
    - 内存划分为系统区和用户区
    - 整个用户区为一道程序独占, 仅驻留一道程序
    - 绝对装入方式
    - 静态链接
    - 基本不设立存储器保护措施, 最多设立界限检查机制
    - 仅适用于单用户、单任务操作系统
#### 2. 固定分区分配内存管理
1. 固定分区分配方式
    - 用户区分为若干固定区域
    - 每个分区可装一道作业
    - 分区划分方法
    - 分区说明表与内存分配算法
    - 可用于多道程序存储管理
2. 地址转换及内存保护
    - 静态链接
    - 可重定位装入、动态运行时装入
    - 保护操作系统程序间互不干扰
    - 仅用于事先确定的场景
#### 3. 动态分区分配内存管理
1. 基本思想
    - 根据进程实际需求, 动态地对内存进行操作
2. 关键问题
    - 分区分配数据结构
    - 算法
    - 回收
    - 碎片处理
3. 数据结构
    <center><img src="/操作系统/All_pic/Screenshot 2024-10-09 at 21.09.38.png" width=50%></img></center>
4. 算法
    - 首次适应算法(First Fit, FF)
        1. 空闲分区链以地址递增次序链接
        2. 查找开销大, 但利于大作业分配
    - 循环首次适应
        1. 首次适应 + 起始查询指针 + 循环查找
        2. 减少查找开销, 不利于大作业分配
    - 最佳适应/最坏适应
        1. 能满足要求且又最小的空闲分区
        2. 空闲分区按大小递增链接
        3. 微观意义上的最佳
#### 4. 动态可重定位分区分配内存管理
1. 紧凑技术
    - 要求内存空间连续性
    - 碎片问题
    - 移动拼接大分区
    - 内存地址变化及地址修正问题
2. 动态重定位
    - 动态运行时装入方式及重定位寄存器
3. 分配算法
    - 动态算法 + 紧凑功能
#### 5. 对换技术
1. 多道程序环境下的对换
    - 对换概念及意义
        1. 内存 <-> 外存
    - 实现机制
        1. UNIX: 对换进程
    - 实现方式
        1. 进程对换: 分时系统
        2. 页面/分段对换: 虚拟存储技术
2. 对换空间管理
    - 文件区和对换区
    - 对换区使用情况数据结构
    - 对换区分配与回收
3. 进程的换出和换入
    - 换出
        1. 进程的选择
        2. 过程
    - 换入
        1. 选择
        2. 过程
#### 6. 覆盖技术
1. 基本思想
    - 不同时执行的程序共享一块内存
    - 覆盖段: 互相覆盖的程序段
    - 覆盖区: 共用的内存空间
#### 7. 伙伴系统
1. Pass
---
### 4-3. 基本分页内存管理
